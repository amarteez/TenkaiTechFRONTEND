{"ast":null,"code":"import axios from'axios';import React,{createContext,useContext,useEffect,useReducer}from'react';// Acciones\nimport{jsx as _jsx}from\"react/jsx-runtime\";const ADD_TO_CART='ADD_TO_CART';const SET_CART_ITEMS='SET_CART_ITEMS';const REMOVE_FROM_CART='REMOVE_FROM_CART';// Crear contexto de carrito\nconst CartContext=/*#__PURE__*/createContext();// Reducer para manejar el estado del carrito\nconst cartReducer=(state,action)=>{switch(action.type){case ADD_TO_CART:// Si el producto ya está en el carrito, actualiza la cantidad\nconst existingItemIndex=state.findIndex(item=>item.id===action.payload.id);if(existingItemIndex>=0){const updatedCart=[...state];updatedCart[existingItemIndex].quantity+=action.payload.quantity;return updatedCart;}// Si el producto no está en el carrito, lo agrega\nreturn[...state,action.payload];case SET_CART_ITEMS:return action.payload;case REMOVE_FROM_CART:return state.filter(item=>item.id!==action.payload);default:return state;}};// Proveedor del contexto de carrito\nexport const CartProvider=_ref=>{let{children}=_ref;const[cart,dispatch]=useReducer(cartReducer,[]);useEffect(()=>{const fetchCartItems=async()=>{try{const response=await axios.get('https://tenkaitechbackend.onrender.com/api/cart/');dispatch({type:SET_CART_ITEMS,payload:response.data});}catch(error){console.error('Error fetching cart items:',error);}};fetchCartItems();},[]);const addToCart=async product=>{try{const response=await axios.post('https://tenkaitechbackend.onrender.com/api/cart/add/',{product_id:product.id,quantity:1// Puedes ajustar la cantidad según sea necesario\n});const cartItem={id:response.data.id,product_id:product.id,name:product.name,price:product.price,quantity:1// Puedes ajustar la cantidad según sea necesario\n};dispatch({type:ADD_TO_CART,payload:cartItem});}catch(error){console.error('Error adding to cart:',error);}};const removeFromCart=async cartItemId=>{try{await axios.post('https://tenkaitechbackend.onrender.com/api/cart/remove/',{cart_item_id:cartItemId});dispatch({type:REMOVE_FROM_CART,payload:cartItemId});}catch(error){console.error('Error removing from cart:',error);}};const getCartTotal=()=>{const total=cart.reduce((sum,item)=>{if(!item.price){console.error('Producto indefinido en carrito:',item);return sum;}return sum+parseFloat(item.price)*item.quantity;},0);const itbms=total*0.07;return{total,itbms,grandTotal:total+itbms};};return/*#__PURE__*/_jsx(CartContext.Provider,{value:{cart,addToCart,removeFromCart,getCartTotal},children:children});};// Hook para usar el contexto de carrito\nexport const useCart=()=>{return useContext(CartContext);};","map":{"version":3,"names":["axios","React","createContext","useContext","useEffect","useReducer","jsx","_jsx","ADD_TO_CART","SET_CART_ITEMS","REMOVE_FROM_CART","CartContext","cartReducer","state","action","type","existingItemIndex","findIndex","item","id","payload","updatedCart","quantity","filter","CartProvider","_ref","children","cart","dispatch","fetchCartItems","response","get","data","error","console","addToCart","product","post","product_id","cartItem","name","price","removeFromCart","cartItemId","cart_item_id","getCartTotal","total","reduce","sum","parseFloat","itbms","grandTotal","Provider","value","useCart"],"sources":["C:/Users/admin/Desktop/TenkaiFront/src/CartContext.js"],"sourcesContent":["import axios from 'axios';\nimport React, { createContext, useContext, useEffect, useReducer } from 'react';\n\n// Acciones\nconst ADD_TO_CART = 'ADD_TO_CART';\nconst SET_CART_ITEMS = 'SET_CART_ITEMS';\nconst REMOVE_FROM_CART = 'REMOVE_FROM_CART';\n\n// Crear contexto de carrito\nconst CartContext = createContext();\n\n// Reducer para manejar el estado del carrito\nconst cartReducer = (state, action) => {\n    switch (action.type) {\n        case ADD_TO_CART:\n            // Si el producto ya está en el carrito, actualiza la cantidad\n            const existingItemIndex = state.findIndex(item => item.id === action.payload.id);\n            if (existingItemIndex >= 0) {\n                const updatedCart = [...state];\n                updatedCart[existingItemIndex].quantity += action.payload.quantity;\n                return updatedCart;\n            }\n            // Si el producto no está en el carrito, lo agrega\n            return [...state, action.payload];\n        case SET_CART_ITEMS:\n            return action.payload;\n        case REMOVE_FROM_CART:\n            return state.filter(item => item.id !== action.payload);\n        default:\n            return state;\n    }\n};\n\n// Proveedor del contexto de carrito\nexport const CartProvider = ({ children }) => {\n    const [cart, dispatch] = useReducer(cartReducer, []);\n\n    useEffect(() => {\n        const fetchCartItems = async () => {\n            try {\n                const response = await axios.get('https://tenkaitechbackend.onrender.com/api/cart/');\n                dispatch({ type: SET_CART_ITEMS, payload: response.data });\n            } catch (error) {\n                console.error('Error fetching cart items:', error);\n            }\n        };\n\n        fetchCartItems();\n    }, []);\n\n    const addToCart = async (product) => {\n        try {\n            const response = await axios.post('https://tenkaitechbackend.onrender.com/api/cart/add/', {\n                product_id: product.id,\n                quantity: 1, // Puedes ajustar la cantidad según sea necesario\n            });\n            const cartItem = {\n                id: response.data.id,\n                product_id: product.id,\n                name: product.name,\n                price: product.price,\n                quantity: 1, // Puedes ajustar la cantidad según sea necesario\n            };\n            dispatch({ type: ADD_TO_CART, payload: cartItem });\n        } catch (error) {\n            console.error('Error adding to cart:', error);\n        }\n    };\n\n    const removeFromCart = async (cartItemId) => {\n        try {\n            await axios.post('https://tenkaitechbackend.onrender.com/api/cart/remove/', {\n                cart_item_id: cartItemId\n            });\n            dispatch({ type: REMOVE_FROM_CART, payload: cartItemId });\n        } catch (error) {\n            console.error('Error removing from cart:', error);\n        }\n    };\n\n    const getCartTotal = () => {\n        const total = cart.reduce((sum, item) => {\n            if (!item.price) {\n                console.error('Producto indefinido en carrito:', item);\n                return sum;\n            }\n            return sum + (parseFloat(item.price) * item.quantity);\n        }, 0);\n        const itbms = total * 0.07;\n        return {\n            total,\n            itbms,\n            grandTotal: total + itbms\n        };\n    };\n\n    return (\n        <CartContext.Provider value={{ cart, addToCart, removeFromCart, getCartTotal }}>\n            {children}\n        </CartContext.Provider>\n    );\n};\n\n// Hook para usar el contexto de carrito\nexport const useCart = () => {\n    return useContext(CartContext);\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}